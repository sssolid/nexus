{% extends "base.html" %}

{% block title %}Product Catalog{% endblock %}

{% block content %}
    <div class="row m-2">
        <!-- Filters Sidebar -->
        <div class="col-md-3">
            <div class="filter-sidebar">
                <h5><i class="fas fa-filter"></i> Filters</h5>
                <form method="get" hx-get="{% url 'products:product_list' %}" hx-target="#product-results"
                      hx-trigger="change">
                    <!-- Search -->
                    <div class="mb-3">
                        <label class="form-label">Search</label>
                        <input type="text" name="search" class="form-control" placeholder="Part number or name..."
                               value="{{ request.GET.search }}">
                    </div>

                    <!-- Category -->
                    <div class="mb-3">
                        <label class="form-label">Category</label>
                        <select name="category" class="form-select">
                            <option value="">All Categories</option>
                            {% for category in categories %}
                                <option value="{{ category.id }}"
                                        {% if request.GET.category == category.id|stringformat:"s" %}selected{% endif %}>
                                    {{ category.name }}
                                </option>
                            {% endfor %}
                        </select>
                    </div>

                    <!-- Manufacturer -->
                    <div class="mb-3">
                        <label class="form-label">Manufacturer</label>
                        <select name="manufacturer" class="form-select">
                            <option value="">All Manufacturers</option>
                            {% for manufacturer in manufacturers %}
                                <option value="{{ manufacturer.id }}"
                                        {% if request.GET.manufacturer == manufacturer.id|stringformat:"s" %}selected{% endif %}>
                                    {{ manufacturer.name }}
                                </option>
                            {% endfor %}
                        </select>
                    </div>

                    <!-- Status -->
                    <div class="mb-3">
                        <label class="form-label">Lifecycle Status</label>
                        <select name="status" class="form-select">
                            <option value="">All</option>
                            <option value="ACTIVE" {% if request.GET.status == 'ACTIVE' %}selected{% endif %}>
                                Active
                            </option>
                            <option value="DISCONTINUED"
                                    {% if request.GET.status == 'DISCONTINUED' %}selected{% endif %}>
                                Discontinued
                            </option>
                        </select>
                    </div>

                    <div class="mb-3">
                        <label class="form-label">Inventory</label>
                        <select name="stock" class="form-select">
                            <option value="">All</option>
                            <option value="in" {% if request.GET.stock == 'in' %}selected{% endif %}>
                                In Stock
                            </option>
                            <option value="out" {% if request.GET.stock == 'out' %}selected{% endif %}>
                                Out of Stock
                            </option>
                        </select>
                    </div>


                    <button type="submit" class="btn btn-primary w-100">
                        <i class="fas fa-search"></i> Apply Filters
                    </button>
                    <a href="{% url 'products:product_list' %}" class="btn btn-secondary w-100 mt-2">
                        <i class="fas fa-undo"></i> Clear Filters
                    </a>
                </form>
            </div>
        </div>

        <!-- Product List -->
        <div class="col-md-9">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h2><i class="fas fa-box"></i> Products</h2>
                <div>
                    <a href="{% url 'exports:export_form' %}" class="btn btn-success">
                        <i class="fas fa-download"></i> Export Data
                    </a>
                </div>
            </div>

            <div id="product-results">
                {% include "products/_product_results.html" %}
            </div>

        </div>
    </div>
{% endblock %}
